<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * Location extension for Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 *
 * @copyright   Copyright (c) 2013 Andrew Kett. (http://www.andrewkett.com)
 * @license     http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */
-->
<config>
  <modules>
    <DigiBrews_Locator>
        <version>0.0.0.3</version>
    </DigiBrews_Locator>
  </modules>
  <global>
    <models>
            <digibrews_locator>
                <class>DigiBrews_Locator_Model</class>
                <resourceModel>digibrews_locator_resource</resourceModel>
            </digibrews_locator>
            <digibrews_locator_resource>
                <class>DigiBrews_Locator_Model_Resource</class>
                <entities>
                    <location>
                        <table>digibrews_locator_location_entity</table>
                    </location>
                    <location_entity_varchar>
                        <table>digibrews_locator_location_entity_varchar</table>
                    </location_entity_varchar>
                    <location_entity_text>
                        <table>digibrews_locator_location_entity_text</table>
                    </location_entity_text>
                    <location_entity_int>
                        <table>digibrews_locator_location_entity_int</table>
                    </location_entity_int>
                    <location_entity_datetime>
                        <table>digibrews_locator_location_entity_datetime</table>
                    </location_entity_datetime>

                    <eav_attribute>
                        <table>digibrews_locator_eav_attribute</table>
                    </eav_attribute>
                    <eav_attribute_website>
                        <table>digibrews_locator_eav_attribute_website</table>
                    </eav_attribute_website>
                    <form_attribute>
                        <table>digibrews_locator_form_attribute</table>
                    </form_attribute>
                </entities>
            </digibrews_locator_resource>
        </models>
        <resources>
            <digibrews_locator_setup>
                <setup>
                    <module>DigiBrews_Locator</module>
                    <class>DigiBrews_Locator_Model_Resource_Setup</class>
                </setup>
            </digibrews_locator_setup>
            <digibrews_locator_write>
                <connection>
                    <use>default_write</use>
                </connection>
            </digibrews_locator_write>
            <digibrews_locator_read>
                <connection>
                    <use>default_read</use>
                </connection>
            </digibrews_locator_read>
        </resources>


    <blocks>
        <digibrews_locator>
            <class>DigiBrews_Locator_Block</class>
        </digibrews_locator>
    </blocks>

    <helpers>
      <digibrews_locator>
        <class>DigiBrews_Locator_Helper</class>
      </digibrews_locator>
    </helpers>

    <index>
        <indexer>
            <locator_url>
                <model>digibrews_locator/indexer_url</model>
            </locator_url>
        </indexer>
    </index>
        <events>
            <controller_front_init_before>
                <observers>
                    <locator_loadlib>
                        <type>model</type>
                        <class>digibrews_locator/observer</class>
                        <method>loadLibraries</method>
                    </locator_loadlib>
                </observers>
            </controller_front_init_before>
        </events>
  </global>
  <adminhtml>
     <menu>
            <digibrews_locator>
                <title>Locator</title>
                <sort_order>70</sort_order>
                <children>
                  <locations>
                    <title>Manage Locations</title>
                    <action>adminhtml/locator</action>
                    <sort_order>30</sort_order>
                  </locations>
                </children>
          </digibrews_locator>
        </menu>
    <layout>
            <updates>
                <locator>
                    <file>locator.xml</file>
                </locator>
            </updates>
        </layout>

        <acl>
            <resources>
                <admin>
                    <children>
                        <system>
                            <children>
                                <config>
                                    <children>
                                        <locator_settings>
                                            <title>Locator Module Section</title>
                                        </locator_settings>
                                    </children>
                                </config>
                            </children>
                        </system>
                    </children>
                </admin>
            </resources>
        </acl>
        <events>
            <controller_action_layout_render_before>
                <observers>
                    <locator_admin_load>
                        <type>model</type>
                        <class>digibrews_locator/observer</class>
                        <method>setAdminMessage</method>
                    </locator_admin_load>
                </observers>
            </controller_action_layout_render_before>
        </events>
  </adminhtml>

  <frontend>
     <routers>
            <locator>
                <use>standard</use>
                <args>
                    <module>DigiBrews_Locator</module>
                    <frontName>locator</frontName>
                </args>
            </locator>
        </routers>
         <layout>
            <updates>
                <locator>
                    <file>locator.xml</file>
                </locator>
            </updates>
        </layout>
  </frontend>
  <admin>
         <routers>
            <adminhtml>
                <args>
                    <modules>
                        <digibrews_locator before="Mage_Adminhtml">DigiBrews_Locator_Adminhtml</digibrews_locator>
                    </modules>
                </args>
            </adminhtml>
        </routers>
    </admin>


    <default>
        <locator_settings>
            <search>
                <append_country_code>1</append_country_code>
                <country_code>AU</country_code>
                <default_search_string>Melbourne, Australia</default_search_string>
                <default_search_distance>5</default_search_distance>
                <show_search_filter>1</show_search_filter>
                <show_distance_filter>1</show_distance_filter>
            </search>
        </locator_settings>
    </default>


</config>
